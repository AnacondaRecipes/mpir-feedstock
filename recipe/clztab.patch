From 171de8daed722b06ad4c99e4b6da99480bc13dd3 Mon Sep 17 00:00:00 2001
From: Brian Gladman <brg@gladman.plus.com>
Date: Mon, 1 Aug 2016 08:31:31 +0100
Subject: [PATCH] change clz_tab array length to 129 to match GMP

---
# .../dll_mpir_sandybridge_ivybridge.vcxproj                           | 2 +-
# .../lib_mpir_sandybridge_ivybridge.vcxproj                           | 2 +-
 build.vc14/mpir.sln                                                  | 2 +-
 longlong_post.h                                                      | 2 +-
 mp_clz_tab.c                                                         | 5 +++--
 5 files changed, 7 insertions(+), 6 deletions(-)

diff --git a/longlong_post.h b/longlong_post.h
index d8a598d..5ec056a 100644
--- a/longlong_post.h
+++ b/longlong_post.h
@@ -294,7 +294,7 @@ extern UWtype mpn_udiv_qrnnd_r _PROTO ((UWtype, UWtype, UWtype, UWtype *));
 #endif
 
 #ifdef COUNT_LEADING_ZEROS_NEED_CLZ_TAB
-extern const unsigned char __GMP_DECLSPEC __clz_tab[128];
+extern const unsigned char __GMP_DECLSPEC __clz_tab[129];
 #endif
 
 #if !defined (count_trailing_zeros)
diff --git a/mp_clz_tab.c b/mp_clz_tab.c
index f4dfca0..6c5b578 100644
--- a/mp_clz_tab.c
+++ b/mp_clz_tab.c
@@ -29,11 +29,12 @@ MA 02110-1301, USA. */
 
 #ifdef COUNT_LEADING_ZEROS_NEED_CLZ_TAB
 const
-unsigned char __clz_tab[128] =
+unsigned char __clz_tab[129] =
 {
   1,2,3,3,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
   7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
   8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
-  8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8
+  8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
+  9
 };
 #endif
